<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="./public/favicon.ico" />
    <meta http-equiv="cache-control" content="no-cache" />
    <title></title>
    <link rel="stylesheet" href=" https://necolas.github.io/normalize.css/8.0.1/normalize.css" />
    <link rel="stylesheet" href="./hightlight/default.min.css" />
    <link rel="stylesheet" href="./css/main.css" />
    <link rel="stylesheet" href="./css/copybutton.css" />
    <link rel="stylesheet" href="./css/hightlight.css" />
    <script src="./hightlight/hightlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BEVZJDBC7Z"></script>
    <script src="./js/gtag.js"></script>
  </head>

  <body>
    <header>
      <nav>
        <h1>
          <span id="toggle-menu"></span>
          <a href="index.html"></a>
        </h1>
      </nav>
    </header>
    <main>
      <aside>
        <nav></nav>
      </aside>
      <article>
        <h2 id="1-6-10">1-6-10 標準化工具管理團隊</h2>
        <p>
          不管是團隊的擴張還是業務的發展，都會導致專案程式量出現爆炸式增長。
          為了防止「野蠻生長」現象，需要有一個良好的技術選型和成熟的架構做支撐，也需要團隊中每一個開發者都能用心維護專案。在此方向上，會使用一些標準工具。
        </p>
        <h3>prettier</h3>
        <p>
          首先從 prettier 說起，所以顧名思義，prettier
          這個工具能夠美化程式，或說格式化、標準化程式，使其更加工整。它一般不會檢查程式的寶際寫法，而是在「可讀性」上做文章，目前支援包含
          JavasScript、JSX、Angular、Vue、Flow 、TypeScript、CSS （Less 、SCSS）、JSON
          等多種語言，以及資料交換格式、語法標準擴充。歸納一下，它能夠將原始程式風格移除，並取代為團隊統一設定的程式風格。幾乎所有團隊都在使用這款工具。
        </p>
        <ul>
          <li>建置並統一程式風格。</li>
          <li>幫助團隊新成員快速融入團隊。</li>
          <li>開發者可以完全聚焦業務開發，不必在程式整理上花費過多心思。</li>
          <li>方便低成本靈活連線，並快速發揮作用。</li>
          <li>清理並標準已有程式。</li>
          <li>減少潛在 bug。</li>
          <li>有豐富強大的社區支援。</li>
        </ul>
        <p>下面來看一個簡單的 demo。首先，透過下面的指令建立一個專案。</p>

        <pre><code class="language-bash">
mkdir prettier-demo && cd prettier-demo
        </code></pre>
        <p>然後，透過下面的指令進行專案初始化。</p>
        <pre><code class="language-bash">
yarn init -y
        </code></pre>
        <p>接著安裝依賴，指令如下。</p>
        <pre><code class="language-bash">
yarn add prettier --dev --exact
        </code></pre>
        <p>在 package.json 檔案中加入 scripts，如下所示。</p>
        <pre><code class="language-js">
{
  "name": "prettier-demo",
  "version": "1.0.0",
  "scripts": {
    "prettier":"prettier --write src/index.js"
  }
}
        </code></pre>
        <p>
          prettier --write src/index.js 的意思是執行 prettier，並對 src/index.js
          檔案進行處理，--write 標識告訴 prettier 要把格式化後的內容儲存到目前檔案中。
        </p>
        <p>在 ./sre 目錄中新增 index.js 檔案，並在檔案中輸入一些格式缺失的程式，如下所示。</p>
        <pre><code class="language-js">
let person = {
  name: "Yoda",
  designation: 'Jedi Master '
}

function trainJedi (jediWarrion) {
  if (jediWarrion.name === 'Yoda') {
    console.log('No need! already trained')
  }
  console.log (`Training ${jediWarrion.name} complete` )
}

trainJedi(person)
trainJedi({name:'Adeel', designation: 'padawan'})
        </code></pre>
        <p>同時，在 root 檔案中建立 prettier.config.js 檔案，並在檔案中增加 prettier 規則。</p>
        <pre><code class="language-js">
module.exports = {
  printWidth: 100, 
  singleQuote: true, 
  trailingComma: 'all', 
  bracketSpacing: true, 
  jsxBracketSameLine: false, 
  tabWidth: 2,
  semi: true,
}
        </code></pre>
        <p>
          prettier
          會讀取這些規則，並按照以上規則設定、美化程式。對於這些規則，透過其名稱便能了解其大概意思，更多內容可去官網檢視。
        </p>
        <p>執行以下指令，程式就會被自動格式化了。</p>
        <pre><code class="language-bash">
yarn prettier
        </code></pre>
        <p>
          當然：prettier 也可以與編輯器結合，在開發者儲存程式後立即對程式進行美化：也可以將 prettier
          整合到 CI 環節或 git pre-commit 階段。舉例來說，使用 pretty-quick
          在程式提交時對程式進行美化，指令如下。
        </p>
        <pre><code class="language-bash">
yarn add prettier pretty-quick husky--dev
        </code></pre>
        <p>同時，需要要在 package.json 中設定以下內容。</p>
        <pre><code class="language-js">
{
  "husky": {
    "hooks": {
      "pre-commit": "pretty-quick —-staged"
    }
  }
}
        </code></pre>
        <p>
          在 husky 中定義 pre-commit 階段，並只對 staged 的檔案進行格式化。 這裡使用了官方推薦的
          pretty-quick 來實現 pre-commit 階段的美化，這只是其中一種實現方式，還可以透過 lint-staged
          來實現。在下面介紹 ESLint 和 husky 時會講到 lint-staged。透過 demo 可以看出，prettier
          確實很靈活，且自動化程度很高，連入專案也十分方便。
        </p>
        <h3>ESLint</h3>
        <p>
          下面來看一下以 ESLint 為代表的 linter。多數程式語言都有
          linter，它們常常被整合在編譯階段，完成 coding linting。code linting
          表示基於靜態分析程式原理找出程式反模式的過程。
        </p>
        <p>
          對 JavaScript 這種動態、鬆類型的語言來說，開發者在撰寫程式時更容易犯錯。由於 JavaScript
          不具備先天編譯流程，因此常常會在執行時期曝露錯誤，而 linter，尤其是最具代表性的
          ESLint，可以使開發者在執行前就發現程式錯誤或不合理的寫法。
        </p>
        <p>ESLint 中最重要的幾點哲學思想如下。</p>
        <ul>
          <li>所有規則都外掛程式化。</li>
          <li>所有規則都可抽換（隨時開關）。</li>
          <li>所有設計都透明化。</li>
          <li>使用 espree 進行 JavaScript 解析。</li>
          <li>使用 AST 分析語法。</li>
        </ul>
        <p>下面來簡單設定一個 ESLint 規則，步驟如下。</p>
        <p>首先，初始化專案，指令如下。</p>
        <pre><code class="language-bash">
yarn init -y
        </code></pre>
        <p>然後，透過以下指令安裝依賴。</p>
        <pre><code class="language-bash">
yarn add eslint --dev
        </code></pre>
        <p>接著，執行以下指令。</p>
        <pre><code class="language-bash">
npx eslint --init
        </code></pre>
        <p>之後就可以使用 eslint 對任意檔案進行處理了，指令如下。</p>
        <pre><code class="language-bash">
eslint XXX.js
        </code></pre>
        <p>當然，想要順利執行 eslint，還需要安裝應用規則外掛程式。</p>
        <p>那麼，如何宣告並使用規則呢？在根目錄中開啟 .eslintrc 設定檔，在該檔案中加入以下內容。</p>
        <pre><code class="language-js">
{
  "rules": {
    "semi": ["error", "always"],
    "quote": ["error", "double"]
  }
}
        </code></pre>
        <p>
          semi、quote 就是 ESLint 規則的名稱，其值對應的陣列第一項可以為
          off/0、warn/1、error/2，分別表示關閉規則、以 warning 形式開啟規則、以 error 形式開啟規則。
        </p>
        <p>同樣，還會在 .eslintrc 檔案中發現以下內容，表示 ESLint 的預設規則都將被開啟。</p>
        <pre><code class="language-js">
"extends": "eslint: recommended"
        </code></pre>
        <p>當然，也可以選取其他規則集合，此較出名的有以下兩個。</p>
        <ul>
          <li>Google JavaScript Style Guide</li>
          <li>Airbnb JavaScript Style Guide</li>
        </ul>
        <p>繼續拆分 .eslintrc 檔案，可以看到它主要由 6 個欄位組成，程式如下。</p>
        <pre><code class="language-js">
module.exports = {
  env: {},
  extends: {},
  parser: {},
  parserOptions: {},
  rules: {},
}
        </code></pre>
        <ul>
          <li>env：指定啟用的環境。</li>
          <li>extends：指定額外設定的選項，如 ['airbnb'] 表示使用 Airbnb 的 linting 規則。</li>
          <li>plugins 設定規則外掛程式。</li>
          <li>parser：預設情況下，ESLint 使用 espree 進行解析。</li>
          <li>parserOptions：如果更改了預設解析器，則需要設定 parserOptions 來自訂解析器。</li>
          <li>rules：定義擴充的及透過外掛程式增加的所有規則。</li>
        </ul>
        <p>
          注意，上述程式採用了.eslintrc.js 的 JavaScript 檔案格式，此外還可以採用.yaml、.json、yml
          等格式。如果專案中含有多種設定檔格式，則優先順序順序如下。
        </p>
        <pre><code class="language-js">
.eslintrc.js
.eslintrc.yaml
.eslintrc.yml
.eslintrc.json
.eslintrc
.package.json
        </code></pre>
        <p>最後，可以在 package.json 中增加 scripts，如下所示。</p>
        <pre><code class="language-js">
"scripts": {
  "lint": "eslint --debug src/"
  "lint:write": "eslint --debug src/ --fix"
}
        </code></pre>
        <p>
          scripts 中的 lint
          將檢查所有檔案，並在每個存在錯誤的檔案中提供詳細記錄檔，但開發者需要手動開啟這些檔案並更正錯誤；lint:write
          與 lint 類似，但它可以自動校正錯誤。
        </p>
        <pre><code class="language-js">

        </code></pre>
        <pre><code class="language-js">

        </code></pre>
        <pre><code class="language-js">

        </code></pre>
        <pre><code class="language-js">

        </code></pre>
        <pre><code class="language-js">

        </code></pre>
        <pre><code class="language-js">

        </code></pre>
        <pre><code class="language-js">

        </code></pre>
        <pre><code class="language-js">

        </code></pre>
        <pre><code class="language-js">

        </code></pre>
      </article>
    </main>
  </body>
  <script type="module" src="./js/main.js"></script>
</html>
