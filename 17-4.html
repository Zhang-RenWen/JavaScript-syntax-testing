<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="./public/favicon.ico" />
    <meta http-equiv="cache-control" content="no-cache" />
    <title></title>
    <link rel="stylesheet" href=" https://necolas.github.io/normalize.css/8.0.1/normalize.css" />
    <link rel="stylesheet" href="./hightlight/default.min.css" />
    <link rel="stylesheet" href="./css/main.css" />
    <link rel="stylesheet" href="./css/copybutton.css" />
    <link rel="stylesheet" href="./css/hightlight.css" />
    <script src="./hightlight/hightlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BEVZJDBC7Z"></script>
    <script src="./js/gtag.js"></script>
  </head>

  <body>
    <header>
      <nav>
        <h1>
          <span id="toggle-menu"></span>
          <a href="index.html"></a>
        </h1>
      </nav>
    </header>
    <main>
      <aside>
        <nav></nav>
      </aside>
      <article>
        <h2 id="17-4">17-4 Array.prototype.findLast</h2>
        <p>
          <code>Array</code>
          實例的
          <code>findLast()</code>
          方法以相反的順序迭代數組，並返回滿足所提供的測試函數的第一個元素的值。如果沒有元素滿足測試功能，則返回
          undefined。
        </p>
        <p>假如你需要找：</p>
        <ul>
          <li>
            the
            <em>first</em>
            element that matches, use
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/find"
            >
              <code>find()</code>
            </a>
            .
          </li>
          <li>
            the
            <em>index</em>
            of the last matching element in the array, use
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/findLastIndex"
            >
              <code>findLastIndex()</code>
            </a>
            .
          </li>
          <li>
            the
            <em>index of a value</em>
            , use
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf"
            >
              <code>indexOf()</code>
            </a>
            . (It's similar to
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/findIndex"
            >
              <code>findIndex()</code>
            </a>
            , but checks each element for equality with the value instead of using a testing
            function.)
          </li>
          <li>
            whether a value
            <em>exists</em>
            in an array, use
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/includes"
            >
              <code>includes()</code>
            </a>
            . Again, it checks each element for equality with the value instead of using a testing
            function.
          </li>
          <li>
            if any element satisfies the provided testing function, use
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/some"
            >
              <code>some()</code>
            </a>
            .
          </li>
        </ul>
        <pre><code class="language-js">
const array1 = [5, 12, 50, 130, 44];

const found = array1.findLast((element) =&gt; element > 45);

console.log(found);
// Expected output: 130
        </code></pre>
        <h3>語法</h3>
        <pre><code class="language-js">
findLast(callbackFn)
findLast(callbackFn, thisArg)
        </code></pre>
        <h3>參數</h3>
        <dl>
          <dt id="callbackfn"><code>callbackFn</code></dt>
          <dd>
            <p>
              A function to execute for each element in the array. It should return a
              <a
                href="https://developer.mozilla.orghttps://developer.mozilla.org/en-US/docs/Glossary/Truthy"
              >
                truthy
              </a>
              value to indicate a matching element has been found, and a
              <a
                href="https://developer.mozilla.orghttps://developer.mozilla.org/en-US/docs/Glossary/Falsy"
              >
                falsy
              </a>
              value otherwise. The function is called with the following arguments:
            </p>
            <dl>
              <dt id="element"><code>element</code></dt>
              <dd>
                <p>The current element being processed in the array.</p>
              </dd>
              <dt id="index"><code>index</code></dt>
              <dd>
                <p>The index of the current element being processed in the array.</p>
              </dd>
              <dt id="array"><code>array</code></dt>
              <dd>
                <p>
                  The array
                  <code>findLast()</code>
                  was called upon.
                </p>
              </dd>
            </dl>
          </dd>
          <dt id="thisarg">
            <code>thisArg</code>
            <span class="badge inline optional">Optional</span>
          </dt>
          <dd>
            <p>
              A value to use as
              <code>this</code>
              when executing
              <code>callbackFn</code>
              . See
              <a
                href="https://developer.mozilla.orghttps://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array#iterative_methods"
              >
                iterative methods
              </a>
              .
            </p>
          </dd>
        </dl>
        <h3>回傳值</h3>
        <p>
          The value of the element in the array with the highest index value that satisfies the
          provided testing function; undefined if no matching element is found.
        </p>
        <h3>說明</h3>

        <p>
          The
          <code>findLast()</code>
          method is an
          <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array#iterative_methods">
            iterative method
          </a>
          . It calls a provided
          <code>callbackFn</code>
          function once for each element in an array in descending-index order, until
          <code>callbackFn</code>
          returns a
          <a href="/en-US/docs/Glossary/Truthy">truthy</a>
          value.
          <code>findLast()</code>
          then returns that element and stops iterating through the array. If
          <code>callbackFn</code>
          never returns a truthy value,
          <code>findLast()</code>
          returns
          <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/undefined">
            <code>undefined</code>
          </a>
          .
        </p>
        <p>
          <code>callbackFn</code>
          is invoked for
          <em>every</em>
          index of the array, not just those with assigned values. Empty slots in
          <a href="/en-US/docs/Web/JavaScript/Guide/Indexed_collections#sparse_arrays">
            sparse arrays
          </a>
          behave the same as
          <code>undefined</code>
          .
        </p>
        <p>
          <code>findLast()</code>
          does not mutate the array on which it is called, but the function provided as
          <code>callbackFn</code>
          can. Note, however, that the length of the array is saved
          <em>before</em>
          the first invocation of
          <code>callbackFn</code>
          . Therefore:
        </p>
        <ul>
          <li>
            <code>callbackFn</code>
            will not visit any elements added beyond the array's initial length when the call to
            <code>findLast()</code>
            began.
          </li>
          <li>
            Changes to already-visited indexes do not cause
            <code>callbackFn</code>
            to be invoked on them again.
          </li>
          <li>
            If an existing, yet-unvisited element of the array is changed by
            <code>callbackFn</code>
            , its value passed to the
            <code>callbackFn</code>
            will be the value at the time that element gets visited.
            <a href="/en-US/docs/Web/JavaScript/Reference/Operators/delete">Deleted</a>
            elements are visited as if they were
            <code>undefined</code>
            .
          </li>
        </ul>
        <div class="notecard warning">
          <p>
            <strong>Warning:</strong>
            Concurrent modifications of the kind described above frequently lead to
            hard-to-understand code and are generally to be avoided (except in special cases).
          </p>
        </div>
        <p>
          The
          <code>findLast()</code>
          method is
          <a href="/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array#generic_array_methods">
            generic
          </a>
          . It only expects the
          <code>this</code>
          value to have a
          <code>length</code>
          property and integer-keyed properties.
        </p>

        <h3>範例：</h3>
        <h3>Find last object in an array matching on element properties</h3>
        <p>
          This example shows how you might create a test based on the properties of array elements.
        </p>
        <pre><code class="language-js">
const inventory = [
  { name: "apples", quantity: 2 },
  { name: "bananas", quantity: 0 },
  { name: "fish", quantity: 1 },
  { name: "cherries", quantity: 5 },
];

// return true inventory stock is low
function isNotEnough(item) {
  return item.quantity &lt; 2;
}

console.log(inventory.findLast(isNotEnough));
// { name: "fish", quantity: 1 }
        </code></pre>
        <h3>Using arrow function and destructuring</h3>
        <p>
          The previous example might be written using an arrow function and object destructuring:
        </p>
        <pre><code class="language-js">
const inventory = [
  { name: "apples", quantity: 2 },
  { name: "bananas", quantity: 0 },
  { name: "fish", quantity: 1 },
  { name: "cherries", quantity: 5 },
];

const result = inventory.findLast(({ quantity }) =&gt; quantity &lt; 2);

console.log(result);
// { name: "fish", quantity: 1 }
        </code></pre>
        <h3>Find the last prime number in an array</h3>
        <p>
          The following example returns the last element in the array that is a prime number, or
          undefined if there is no prime number.
        </p>
        <pre><code class="language-js">
function isPrime(element) {
  if (element % 2 === 0 || element &lt; 2) {
    return false;
  }
  for (let factor = 3; factor &lt;= Math.sqrt(element); factor += 2) {
    if (element % factor === 0) {
      return false;
    }
  }
  return true;
}

console.log([4, 6, 8, 12].findLast(isPrime)); // undefined, not found
console.log([4, 5, 7, 8, 9, 11, 12].findLast(isPrime)); // 11
        </code></pre>
        <h3>Using findLast() on sparse arrays</h3>
        <p>
          Empty slots in sparse arrays are visited, and are treated the same as
          <code>undefined</code>
          .
        </p>
        <pre><code class="language-js">
// Declare array with no elements at indexes 2, 3, and 4
const array = [0, 1, , , , 5, 6];

// Shows all indexes, not just those with assigned values
array.findLast((value, index) =&gt; {
  console.log(`Visited index ${index} with value ${value}`);
});
// Visited index 6 with value 6
// Visited index 5 with value 5
// Visited index 4 with value undefined
// Visited index 3 with value undefined
// Visited index 2 with value undefined
// Visited index 1 with value 1
// Visited index 0 with value 0

// Shows all indexes, including deleted
array.findLast((value, index) =&gt; {
  // Delete element 5 on first iteration
  if (index === 6) {
    console.log(`Deleting array[5] with value ${array[5]}`);
    delete array[5];
  }
  // Element 5 is still visited even though deleted
  console.log(`Visited index ${index} with value ${value}`);
});
// Deleting array[5] with value 5
// Visited index 6 with value 6
// Visited index 5 with value undefined
// Visited index 4 with value undefined
// Visited index 3 with value undefined
// Visited index 2 with value undefined
// Visited index 1 with value 1
// Visited index 0 with value 0

        </code></pre>
        <h3>Calling findLast() on non-array objects</h3>
        <p>
          The findLast() method reads the length property of this and then accesses each property
          whose key is a nonnegative integer less than length.
        </p>
        <pre><code class="language-js">
const arrayLike = {
  length: 3,
  0: 2,
  1: 7.3,
  2: 4,
  3: 3, // ignored by findLast() since length is 3
};
console.log(
  Array.prototype.findLast.call(arrayLike, (x) =&gt; Number.isInteger(x)),
); // 4

        </code></pre>
        <p>資料來源:</p>
        <p>
          <a
            href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/findLast#find_last_object_in_an_array_matching_on_element_properties"
          >
            https://developer.mozilla.org/.../findLast
          </a>
        </p>
        <p>
          <a
            href="https://www.infoworld.com/article/3703571/all-the-new-features-in-ecmascript-2023-es14.html"
          >
            all-the-new-features-in-ecmascript-2023-es14
          </a>
        </p>
      </article>
    </main>
  </body>
  <script type="module" src="./js/main.js"></script>
</html>
