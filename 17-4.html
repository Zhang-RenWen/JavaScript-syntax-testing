<!DOCTYPE html>
<html lang="zh-TW">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="icon" href="./public/favicon.ico" />
    <meta http-equiv="cache-control" content="no-cache" />
    <title></title>
    <link rel="stylesheet" href=" https://necolas.github.io/normalize.css/8.0.1/normalize.css" />
    <link rel="stylesheet" href="./hightlight/default.min.css" />
    <link rel="stylesheet" href="./css/main.css" />
    <link rel="stylesheet" href="./css/copybutton.css" />
    <link rel="stylesheet" href="./css/hightlight.css" />
    <script src="./hightlight/hightlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js"></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-BEVZJDBC7Z"></script>
    <script src="./js/gtag.js"></script>
  </head>

  <body>
    <header>
      <nav>
        <h1>
          <span id="toggle-menu"></span>
          <a href="index.html"></a>
        </h1>
      </nav>
    </header>
    <main>
      <aside>
        <nav></nav>
      </aside>
      <article>
        <h2 id="17-4">17-4 Array.prototype.findLast</h2>
        <p>
          <code>Array</code>
          實例的
          <code>findLast()</code>
          方法以相反的順序迭代陣列，並回傳滿足所提供的測試函數的第一個元素的值。如果沒有元素滿足測試功能，則回傳
          undefined。
        </p>
        <p>假如你需要找：</p>
        <ul>
          <li>
            第一個匹配的元素，使用
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/find"
            >
              <code>find()</code>
            </a>
            。
          </li>
          <li>
            陣列中最後一個匹配元素的索引，使用
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/findLastIndex"
            >
              <code>findLastIndex()</code>
            </a>
            .
          </li>
          <li>
            值的索引，使用
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/indexOf"
            >
              <code>indexOf()</code>
            </a>
            。 （它類似於
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/findIndex"
            >
              <code>findIndex()</code>
            </a>
            ，但檢查每個元素是否與值相等，而不是使用測試函數。）
          </li>
          <li>
            陣列中是否存在某個值，請使用
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/includes"
            >
              <code>includes()</code>
            </a>
            。同樣，它檢查每個元素是否與值相等，而不是使用測試函數。
          </li>
          <li>
            如果任何元素滿足提供的測試功能，請使用
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/some"
            >
              <code>some()</code>
            </a>
            .
          </li>
        </ul>
        <pre><code class="language-js">
const array1 = [5, 12, 50, 130, 44];

const found = array1.findLast((element) =&gt; element > 45);

console.log(found);
// Expected output: 130
        </code></pre>
        <h3>語法</h3>
        <pre><code class="language-js">
findLast(callbackFn)
findLast(callbackFn, thisArg)
        </code></pre>
        <h3>參數</h3>
        <dl>
          <dt id="callbackfn"><code>callbackFn</code></dt>
          <dd>
            <p>
              對陣列中的每個元素執行的函數。它應該回傳一個
              <code>truthy</code>
              來指示已找到匹配元素，否則回傳一個
              <code>falsy</code>
              。使用以下參數調用該函數：
            </p>
            <dl>
              <dt id="element"><code>element</code></dt>
              <dd>
                <p>陣列中當前正在處理的元素。</p>
              </dd>
              <dt id="index"><code>index</code></dt>
              <dd>
                <p>陣列中當前正在處理的元素的索引。陣列中正在處理的元素。</p>
              </dd>
              <dt id="array"><code>array</code></dt>
              <dd>
                <p>
                  調用了陣列
                  <code>findLast()</code>
                  。
                </p>
              </dd>
            </dl>
          </dd>
          <dt id="thisarg">
            <code>thisArg</code>
            <span class="badge inline optional">Optional</span>
          </dt>
          <dd>
            <p>
              執行
              <code>callbackFn</code>
              時用作
              <code>this</code>
              的值。
              <a
                href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array#iterative_methods"
              >
                迭代的方法(iterative methods)
              </a>
              .
            </p>
          </dd>
        </dl>
        <h3>回傳值</h3>
        <p>
          陣列中索引值最高且滿足以下條件的元素的值提供測試功能；如果未找到匹配元素，則
          <code>undefined</code>
          。
        </p>
        <h3>說明</h3>

        <p>
          <code>findLast()</code>
          方法是一種迭代方法。它按降序索引順序為陣列中的每個元素調用一次提供的
          <code>callbackFn</code>
          函數，直到
          <code>callbackFn</code>
          回傳
          <code>truthy</code>
          。
          <code>findLast()</code>
          然後回傳該元素並停止遍歷陣列。如果
          <code>callbackFn</code>
          從不回傳
          <code>truthy</code>
          ，則
          <code>findLast()</code>
          回傳
          <code>undefined</code>
          。
        </p>
        <p>
          為陣列的每個索引調用
          <code>callbackFn</code>
          ，而不僅僅是那些具有指定值的索引。
          <a
            href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Indexed_collections#sparse_arrays"
          >
            稀疏陣列
          </a>
          中的空槽的行為與
          <code>undefined</code>
          相同。
        </p>
        <p>
          <code>findLast()</code>
          不會改變調用它的陣列，但作為
          <code>callbackFn</code>
          提供的函數可以。但請注意，陣列的長度是在第一次調用
          <code>callbackFn</code>
          之前保存的。所以：
        </p>
        <ul>
          <li>
            當調用
            <code>findLast()</code>
            開始時，
            <code>callbackFn</code>
            不會訪問超出陣列初始長度的任何元素。
          </li>
          <li>
            給已訪問過的索引重新賦值將不會被
            <code>callbackFn</code>
            重新訪問。
          </li>
          <li>
            如果
            <code>callbackFn</code>
            更改了陣列中現有的、尚未訪問的元素，則傳遞給
            <code>callbackFn</code>
            的其值將是該元素被訪問時的值。訪問
            <a
              href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/delete"
            >
              已刪除
            </a>
            的元素就好像它們
            <code>undefined</code>
            一樣。
          </li>
        </ul>
        <div class="notecard warning">
          <p>
            <strong>警告:</strong>
            上一段描述的並發修改的情況經常導致難以理解的代碼，通常應該避免（特殊情況除外）。
          </p>
        </div>
        <p>
          <code>findLast()</code>
          方法是通用的。它只期望
          <code>this</code>
          值具有
          <code>length</code>
          屬性和整數鍵的屬性。
        </p>

        <h3>範例：</h3>
        <h3>
          Find last object in an array matching on element properties
          查找陣列中與元素屬性匹配的最後一個物件
        </h3>
        <p>此範例顯示如何根據陣列元素的屬性創建測試。</p>
        <pre><code class="language-js">
const inventory = [
  { name: "apples", quantity: 2 },
  { name: "bananas", quantity: 0 },
  { name: "fish", quantity: 1 },
  { name: "cherries", quantity: 5 },
];

// return true inventory stock is low
function isNotEnough(item) {
  return item.quantity &lt; 2;
}

console.log(inventory.findLast(isNotEnough));
// { name: "fish", quantity: 1 }
        </code></pre>
        <h3>Using arrow function and destructuring 使用箭頭函數和解構</h3>
        <p>前面的範例可以使用箭頭函數和物件解構來編寫：</p>
        <pre><code class="language-js">
const inventory = [
  { name: "apples", quantity: 2 },
  { name: "bananas", quantity: 0 },
  { name: "fish", quantity: 1 },
  { name: "cherries", quantity: 5 },
];

const result = inventory.findLast(({ quantity }) =&gt; quantity &lt; 2);

console.log(result);
// { name: "fish", quantity: 1 }
        </code></pre>
        <h3>Find the last prime number in an array 查找陣列中的最後一個質數</h3>
        <p>
          以下範例回傳陣列中最後一個質數元素，如果不存在質數則回傳
          <code>undefined</code>
          。
        </p>
        <pre><code class="language-js">
function isPrime(element) {
  if (element % 2 === 0 || element &lt; 2) {
    return false;
  }
  for (let factor = 3; factor &lt;= Math.sqrt(element); factor += 2) {
    if (element % factor === 0) {
      return false;
    }
  }
  return true;
}

console.log([4, 6, 8, 12].findLast(isPrime)); // undefined, not found
console.log([4, 5, 7, 8, 9, 11, 12].findLast(isPrime)); // 11
        </code></pre>
        <h3>Using findLast() on sparse arrays</h3>
        <p>
          稀疏陣列中的空槽會被訪問，並被視為與
          <code>undefined</code>
          相同 .
        </p>
        <pre><code class="language-js">
// Declare array with no elements at indexes 2, 3, and 4
const array = [0, 1, , , , 5, 6];

// Shows all indexes, not just those with assigned values
array.findLast((value, index) =&gt; {
  console.log(`Visited index ${index} with value ${value}`);
});
// Visited index 6 with value 6
// Visited index 5 with value 5
// Visited index 4 with value undefined
// Visited index 3 with value undefined
// Visited index 2 with value undefined
// Visited index 1 with value 1
// Visited index 0 with value 0

// Shows all indexes, including deleted
array.findLast((value, index) =&gt; {
  // Delete element 5 on first iteration
  if (index === 6) {
    console.log(`Deleting array[5] with value ${array[5]}`);
    delete array[5];
  }
  // Element 5 is still visited even though deleted
  console.log(`Visited index ${index} with value ${value}`);
});
// Deleting array[5] with value 5
// Visited index 6 with value 6
// Visited index 5 with value undefined
// Visited index 4 with value undefined
// Visited index 3 with value undefined
// Visited index 2 with value undefined
// Visited index 1 with value 1
// Visited index 0 with value 0

        </code></pre>
        <h3>Calling findLast() on non-array objects 在類陣列物件中使用 findLast()</h3>
        <p>
          <code>findLast()</code>
          方法讀取
          <code>this</code>
          的
          <code>length</code>
          屬性，然後訪問每個屬性 其鍵是小於
          <code>length</code>
          的非負整數。
        </p>
        <pre><code class="language-js">
const arrayLike = {
  length: 3,
  0: 2,
  1: 7.3,
  2: 4,
  3: 3, // ignored by findLast() since length is 3
};
console.log(
  Array.prototype.findLast.call(arrayLike, (x) =&gt; Number.isInteger(x)),
); // 4

        </code></pre>
        <p>資料來源:</p>
        <p>
          <a
            href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/findLast#find_last_object_in_an_array_matching_on_element_properties"
          >
            https://developer.mozilla.org/.../findLast
          </a>
        </p>
        <p>
          <a
            href="https://www.infoworld.com/article/3703571/all-the-new-features-in-ecmascript-2023-es14.html"
          >
            all-the-new-features-in-ecmascript-2023-es14
          </a>
        </p>
      </article>
    </main>
  </body>
  <script type="module" src="./js/main.js"></script>
</html>
